CREATE DATABASE AIRLINE1;
USE AIRLINE1;

CREATE TABLE FLIGHTS(
    FL_ID INT,FROM_PLACE VARCHAR(20),
    TO_PLACE VARCHAR(20),
    DISTANCE INT,
    DEPARTS TIME,
    ARRIVES TIME,
    PRICE INT,
    PRIMARY KEY(FL_ID));

CREATE TABLE AIRCRAFT(
    A_ID INT,
    A_NAME VARCHAR(10),
    CRUISING_RANGE INT,
    PRIMARY KEY(A_ID));

CREATE TABLE EMPLOYEE(
    E_ID INT,
    E_NAME VARCHAR(10),
    SALARY INT,
    PRIMARY KEY(E_ID));

CREATE TABLE CERTIFIED(
    E_ID INT,
    A_ID INT,
    FOREIGN KEY(E_ID) REFERENCES EMPLOYEE(E_ID),
    FOREIGN KEY(A_ID) REFERENCES AIRCRAFT(A_ID));

INSERT INTO FLIGHTS VALUES(111,'BENGALURU','FRANKFURT',1000,'09:30','16:00',10000);
INSERT INTO FLIGHTS VALUES(222,'MANDISON','BENGALURU',1020,'01:30','7:00',9000);
INSERT INTO FLIGHTS VALUES(333,'BENGALURU','FRANKFURT',1000,'01:40','12:00',9500);
INSERT INTO FLIGHTS VALUES(555,'NEW DELHI','NEW YORK',5000,'13:30','17:00',15000);
INSERT INTO FLIGHTS VALUES(444,'BENGALURU','NEW DELHI',550,'08:00','13:00',5000);
INSERT INTO FLIGHTS VALUES(666,'MANDISION','NEW YORK',12000,'16:30','19:00',20000);
SELECT * FROM FLIGHTS;

INSERT INTO AIRCRAFT VALUES(10,'AIR ASIA',12000);
INSERT INTO AIRCRAFT VALUES(20,'GO AIR',2000);
INSERT INTO AIRCRAFT VALUES(30,'AIR ASIA',600);
INSERT INTO AIRCRAFT VALUES(40,'INDIGO',5000);
INSERT INTO AIRCRAFT VALUES(50,'SPICE JET',900);
INSERT INTO AIRCRAFT VALUES(60,'SPICE JET',12500);
SELECT * FROM AIRCRAFT;

INSERT INTO EMPLOYEE VALUES(3,'SHAAN',60000);
INSERT INTO EMPLOYEE VALUES(2,'TANYA',15000);
INSERT INTO EMPLOYEE VALUES(4,'RAJATH',81000);
INSERT INTO EMPLOYEE VALUES(1,'SAM',82000);
INSERT INTO EMPLOYEE VALUES(6,'AYMAN',70000);
INSERT INTO EMPLOYEE VALUES(5,'SAAKSHI',9000);
SELECT * FROM EMPLOYEE;

INSERT INTO CERTIFIED VALUES(1,10);
INSERT INTO CERTIFIED VALUES(4,10);
INSERT INTO CERTIFIED VALUES(3,40);
INSERT INTO CERTIFIED VALUES(5,30);
INSERT INTO CERTIFIED VALUES(5,50);
INSERT INTO CERTIFIED VALUES(4,50);
INSERT INTO CERTIFIED VALUES(4,20);
INSERT INTO CERTIFIED VALUES(4,30);
SELECT * FROM CERTIFIED;
SELECT A.A_NAME FROM AIRCRAFT A INNER JOIN CERTIFIED C ON A.A_ID=C.A_ID INNER JOIN EMPLOYEE E ON C.E_ID=E.E_ID WHERE E.SALARY>80000;
select C.E_ID ,max(A.CRUISING_RANGE) FROM CERTIFIED C ,AIRCRAFT A WHERE C.A_ID=A.A_ID GROUP BY C.E_ID HAVING COUNT(*)>3;
